package Utilitats

import javax.swing.*
import java.awt.*
import java.io.File


class Finestra : JFrame() {
	val fCh = JFileChooser(".")
	val taula = JTable(1, 6)

	init {

		defaultCloseOperation = JFrame.EXIT_ON_CLOSE
		setTitle("Crear apunts Quotes")
		setSize(400, 300)
		setLayout(BorderLayout())

		val panell1 = JPanel(FlowLayout())
		val panell2 = JPanel(BorderLayout())
		add(panell1, BorderLayout.NORTH)
		add(panell2, BorderLayout.CENTER)


		val fitxer = JTextField(25)
		panell1.add(fitxer)
		val botoTriarFitxer = JButton("Triar fitxer")
		panell1.add(botoTriarFitxer)


		panell2.add(JLabel("Llista de m√∫sics i quotes:"), BorderLayout.NORTH)
		taula.setEnabled(false)
		val scroll = JScrollPane(taula)
		panell2.add(scroll, null)
		//val area = JTextArea()
		//panell2.add(area)

		botoTriarFitxer.addActionListener {
			val r = fCh.showOpenDialog(this)
			if (r == JFileChooser.APPROVE_OPTION) {
				fitxer.setText(fCh.getSelectedFile().getName())
				val f = fCh.getSelectedFile()
				val linies = f.readLines()

				plenarTaula(linies)
			}
		}

	}

	fun plenarTaula(linies: List<String>) {
		var ll = Array(linies.size) { arrayOfNulls<String>(6) }
		var compt=0
		for (i in 0 until linies.size) {
			val camps = linies.get(i).split(";")
			if (camps.get(5) != "0") {
				for (j in 0 until camps.size) {
					ll[compt][j] = camps.get(j)
					
				}
				compt++
			}
		}
		val ll2 =Array(compt+1) {arrayOfNulls<String>(6)}
		ll.copyInto(ll2,0,0,compt+1)
		val caps = arrayOf("Num", "Cognoms", "Nom", "Data", "Estudis","Quota")
		taula.setModel(javax.swing.table.DefaultTableModel(ll2, caps))
	}
}


fun main(args: Array<String>) {
	EventQueue.invokeLater {
		Finestra().isVisible = true
	}
}

